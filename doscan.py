#!/usr/bin/env python
import requests
import re
import urlparse

class VulnScanner:
    def __init__(self, url):
        self.target_website = url
        self.found_links = []

    def get_links(self, webpage):
        page = requests.get(webpage).content
        return re.findall('(?:href=")(.*?)"', page)

    def seek_page(self, target_site=None):
        if target_site == None:
            target_page = "http://" + self.target_website
        else:
            target_page = target_site
        links = self.get_links(target_page)
        for url in links:
            url = urlparse.urljoin(target_page, url)
            if self.target_website.split(".")[0] in url and url not in self.found_links and "#" not in url:
                self.found_links.append(url)
                print("[+] " + url)
                self.seek_page(url)