#!/usr/bin/env python
import requests
import re
import urlparse

class VulnScanner:
    def __init__(self, url):
        self.session = requests.Session()
        self.target_website = url
        self.found_links = []

    def get_links(self, webpage):
        page = self.session.get(webpage).content
        return re.findall('(?:href=")(.*?)"', page)

    def seek_page(self, target_site=None):
        if target_site == None:
            target_page = "http://" + self.target_website
        else:
            target_page = target_site
        links = self.get_links(target_page)
        for link in links:
            link = urlparse.urljoin(target_page, link)
            if self.target_website.split(".")[0] in link and link not in self.found_links and "#" not in link and "logout" not in link:
                self.found_links.append(link)
                print("[+] " + link)
                self.seek_page(link)
